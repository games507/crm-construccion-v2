<?php
namespace App\Http\Controllers\Auth; use App\Http\Controllers\Controller; use Illuminate\Http\Request; use Illuminate\Support\Facades\Auth;
class LoginController extends Controller{ public function create(){ return view('auth.login'); } public function store(Request $r){ $cred=$r->validate(['email'=>['required','email'],'password'=>['required']]); if(Auth::attempt($cred,true)){ $r->session()->regenerate(); return redirect()->intended(route('dashboard')); } return back()->withErrors(['email'=>'Credenciales no coinciden.'])->onlyInput('email'); } public function destroy(Request $r){ Auth::logout(); $r->session()->invalidate(); $r->session()->regenerateToken(); return redirect()->route('login'); }}
